\documentclass{article}

\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{hyperref}
\usepackage{float}
\usepackage{multirow}
\usepackage{adjustbox}
\usepackage{graphicx}
\usepackage{pdflscape}
\usepackage[shortlabels]{enumitem}
\usepackage{array}
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}


\hypersetup{
	colorlinks=true,       % false: boxed links; true: colored links
	linkcolor=red,          % color of internal links (change box color with 
	%linkbordercolor)
	citecolor=green,        % color of links to bibliography
	filecolor=magenta,      % color of file links
	urlcolor=cyan           % color of external links
}

\title{Hazard Analysis\\\progname}

\author{\authname}

\date{}

\input{../Comments}
\input{../Common}

\begin{document}
	
\maketitle
\thispagestyle{empty}

~\newpage

\pagenumbering{roman}

\begin{table}[hp]
	\caption{Revision History} \label{TblRevisionHistory}
	\begin{tabularx}{\textwidth}{llX}
		\toprule
		\textbf{Date} & \textbf{Developer(s)} & \textbf{Change}\\
		\midrule
		Date1 & Name(s) & Description of changes\\
		Date2 & Name(s) & Description of changes\\
		... & ... & ...\\
		\bottomrule
	\end{tabularx}
\end{table}

~\newpage

\tableofcontents

~\newpage

\pagenumbering{arabic}

\wss{You are free to modify this template.}

\section{Introduction}

\wss{You can include your definition of what a hazard is here.}

\section{Scope and Purpose of Hazard Analysis}

\section{System Boundaries and Components}
The system boundaries for this hazard analysis will include the device that the application is installed on as well as the components of the application itself. These components consist of image upload, image pre-processing, image processing \& identification, API request calling, data logging, data log access, and data display components.

\subsection{Image Upload}
This component allows an image to be uploaded and relayed to the pre-processing component.

\subsection{Image Pre-Processing}
This component takes an uploaded image and applies the algorithms needed to convert the raw image data into a format that can be used by a machine learning image model.

\subsection{Image Processing \& Identification}
This component is where the machine learning model analyzes the pre-processed image to identify the food displayed by comparing it to the images it was exposed to during its supervised learning. 

\subsection{API Request Calling}
This component allows the application to interface with the Nutritionix API to access nutritional data on a given food.  

\subsection{Data Logging}
This component logs past uses of the application by the identified food and the date it was used.   

\subsection{Data Log Access}
This component returns the recorded logs of past uses of the application.

\subsection{Data Display}
This component displays data visually for the user to see, either in textual or graphical formats.

\section{Critical Assumptions}

\wss{These assumptions that are made about the software or system.  You 
should
	minimize the number of assumptions that remove potential hazards.  For 
	instance,
	you could assume a part will never fail, but it is generally better to 
	include
	this potential failure mode.}

\section{Failure Mode and Effect Analysis}

\begin{landscape}
	\thispagestyle{empty}
\begin{table}[ht]
	\centering

	\makebox[\linewidth]{
	\begin{tabular}{|p{2cm}|p{3cm}|p{3cm}|p{3cm}|p{3cm}|p{2cm}|p{3cm}|p{1cm}|p{1cm}|}
		\hline
		\multicolumn{9}{|c|}{\textbf{Failure Mode and Effects Analysis}}\\
		\multicolumn{9}{|l|}{System: Utrition}\\
		\multicolumn{9}{|l|}{Subsystem: N/A}\\
		\multicolumn{9}{|l|}{Phase/Mode: System Requirements}\\\hline
		\textbf{Design Function} & \textbf{Failure Modes} & \textbf{Effects of Failure} & \textbf{Causes of Failure} & \textbf{Detection} & \textbf{Risk Priority Number} & \textbf{Recommended Actions} & \textbf{SR} & \textbf{Ref} \\ \hline
		Image Collection & Image of incorrect type inputted & Users attempt to upload a file of an unsupported type & No image uploaded & Upload error will occur & & Provide error message that informs the user that only file types of type .png, .jpg, and .jpeg can be uploaded & & H1-1 \\ \cline{2-9}
		& Image size inputted is too large & Image file from user is too large to be uploaded and stored & Same as H1-1 & Same as H1-1 & & Provide error message that inputted file is too large & & H1-2\\ \cline{2-9}
		& User tries to upload more than 3 images at once & User attempts to upload more than 3 images & Same as H1-1 & Same as H1-1 & & Provide error message saying up to 3 photos can be uploaded at once & & H1-3\\ \hline
		General System & User loses internet connection & Internet connection used by device is lost or is too weak & Unable to access nutrition facts for food items & API calls will fail & & Provide error message that informs the user that they must be connected to an internet connection to use the system & & H2-1 \\ \cline{2-9}
		& System closes unexpectedly & a. Host device shuts down (loses power) & a. Loss of recently inputted data & a. Device screen will turn black & & a. System should save data with each new input to minimize lost data & & \multirow{2}{*}{H2-2}\\
		& & b. Internal error occurs & b. Same as H2-2a & b. Application will become unresponsive & & b. Same as H2-2a & &\\ \hline
		Database & Nutritional data is unavailable & Nutritional data has not been put in the data base for that particular input yet & System will not output any nutritional information after users request & Nothing will be outputted after api recognition of key food item & & Display error message explaining that this nutritional data has not yet been added to the database & & H3-1 \\ \cline{2-9}
		& Nutritional data is deleted unintentionally & Accidental error of developers deleting necessary data & Same as H3-1 & Same as H3-1 & & Display error message explaining that this nutritional data has been deleted & & H3-2\\ \cline{2-9}
		& User past data is deleted & The data was not successfully stored within the data base or the users past data was deleted unintentionally & System will not output any of the users information after users request  & Nothing will be outputted after user requests past data  & & Display error message saying that the users past data has been deleted  & & H3-3\\ \hline
		Graph Creation & Graph cannot be generated  & Not enough past information from user  & Cannot output a graph for user to see & There is no information available in users past data  & & Display error message stating there is not enough data to create the graph & & H6-1 \\ \cline{2-9}
		
		

	\end{tabular}
}

	\caption{FMEA Table}
	\label{tab:my_label}
\end{table}
\end{landscape}

\section{Safety and Security Requirements}
\subsection{Safety Requirements}
\begin{enumerate}[{SR}1.]
	\item Utrition will be able to detect when the user uploads an abnormal 
	image format, too many images, or images that are too large. A prompt will 
	be given to the user, instructing them of their error. \\
	\textbf{Rationale:}  Utrition should not crash by improper user 
	input. Users should have an opportunity to amend a their faulty input in 
	order to use the services provided by the application.\\	
	\textbf{Associated Hazards:} H1-1, H1-2, H1-3.
	
	\item Utrition will abort retrieval of nutritional information if it cannot 
	be completed successfully. The user will be notified when such 
	an error occurs. \\
	\textbf{Rationale:}  Information retrieval may fail due to a variety of 
	reasons, and the user should be notified of the reason why the service 
	could not be completed as expected.\\	
	\textbf{Associated Hazards:} H2-1, H2-2, H3-1, H3-2, H3-3, H4-1, H5-1. H5-2.
	
	\item Utrition will prompt the user if food identification cannot 
	be completed successfully. The user will be notified on the type of error 
	that occurs. \\
	\textbf{Rationale:}  Food identification may fail due to a variety of 
	reasons, and the user should be notified so they may attempt to find a  
	workaround for the issue. \\	
	\textbf{Associated Hazards:} H5-1. H5-2.
	
	\item Utrition will prompt the user if past nutritional trends cannot
	be displayed successfully. The user will be notified on the type of error 
	that occurs. \\
	\textbf{Rationale:}  Failure to display past nutritional trends may fail 
	due to a variety of reasons. The user should be be made aware of the issue, 
	and the underlying cause behind it.\\	
	\textbf{Associated Hazards:} H6-1.
\end{enumerate}

\subsection{Security Requirements}
\begin{enumerate}[{SR}1.] 
	\setcounter{enumi}{4}
	
	\item Utrition will store the user’s data locally. \\
	\textbf{Rationale:} Only the user should have to view their stored dietary 
	habits. \\	
	\textbf{Associated Hazards:} H4-2.
	
	\item Utrition will periodically save user’s data during use. \\
	\textbf{Rationale:} In the event of unexpected shutdown, the user should 
	not lose all information from the last session. Periodically saving user 
	information will allow users to continue from their last step in the event 
	of an unexpected shutdown. \\	
	\textbf{Associated Hazards:} H4-2.
\end{enumerate}

\section{Roadmap}

\wss{Which safety requirements will be implemented as part of the capstone 
timeline?
	Which requirements will be implemented in the future?}
	
\end{document}
